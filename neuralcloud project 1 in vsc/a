this code is base on GPU not cpu